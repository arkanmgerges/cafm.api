FROM python:3.8-slim

COPY . /app
WORKDIR /app

RUN pip install -qr requirements.txt

ENV CAFM_API_LOGGING=DEBUG
ENV CAFM_API_LOGGING_MAX_FILE_LINES=7
ENV SECRET_TOKEN=1234
ENV MESSAGE_BROKER_SERVERS='localhost:9092'
ENV MESSAGE_SCHEMA_REGISTRY_URL='http://localhost:8081'
ENV CAFM_API_COMMAND_TOPIC='cafm.api.cmd'
ENV CAFM_API_RESPONSE_TOPIC='cafm.api.rsp'
ENV CAFM_API_CONSUMER_GROUP_RSP_NAME='cafm.api.consumer-group.rsp'
ENV CAFM_API_REDIS_HOST='localhost'
ENV CAFM_API_REDIS_PORT=6379
ENV CAFM_API_REDIS_RSP_KEY_PREFIX='cafm.api.rsp.'
ENV CAFM_API_REDIS_RSP_TOPIC_TTL_IN_SECONDS=172800
ENV CAFM_IDENTITY_GRPC_SERVER_SERVICE='localhost'
ENV CAFM_IDENTITY_GRPC_SERVER_SERVICE_PORT=9999



EXPOSE 8000
ENTRYPOINT ["uvicorn", "src.port_adapter.api.rest.main:app", "--host", "0.0.0.0", "--port", "8000"]
